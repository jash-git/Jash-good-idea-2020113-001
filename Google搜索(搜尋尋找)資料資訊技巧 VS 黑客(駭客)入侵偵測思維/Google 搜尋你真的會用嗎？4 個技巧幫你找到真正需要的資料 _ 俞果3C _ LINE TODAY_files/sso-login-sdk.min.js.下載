!function(n,t){"use strict";var o="__is_login_sso",e="1",i={NOT_SUPPORTED_BROWSER:"not_supported_browser",TIMEOUT:"timeout",FAIL:"fail",LOGIN_REQUIRED:"login_required",ERROR_RESPONSE:"error_response"},r=["line-local.me","line-alpha.me","line-beta.me","line-rc.me","line.me"],s={getItem:function(e){if(!e||!this.hasItem(e))return null;var n=new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*");return unescape(t.cookie.replace(n,"$1"))},removeItem:function(e,n){e&&this.hasItem(e)&&n&&(t.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; domain="+n)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(t.cookie)}},a=function(e,n,t,o){var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.setRequestHeader("Accept","application/json"),r.withCredentials=!0,r.onload=function(){4===r.readyState&&(200===r.status?t(r):o(r))},r.onerror=function(){o(i.FAIL)},r.ontimeout=function(){o(i.TIMEOUT)},r.send(n)},u=function(e){var n="",t=!0;for(var o in e)if(e.hasOwnProperty(o)){var r=o+"="+encodeURIComponent(e[o]);t?t=!1:r="&"+r,n+=r}return n},p=function(){if(-1!==n.navigator.userAgent.toLowerCase().indexOf("msie")){var e=n.navigator.appVersion.toLowerCase();if(-1!==e.indexOf("msie 6."))return!0;if(-1!==e.indexOf("msie 7."))return!0;if(-1!==e.indexOf("msie 8."))return!0;if(-1!==e.indexOf("msie 9."))return!0}return!1};String.prototype.endsWith||(String.prototype.endsWith=function(e,n){var t=this.toString();("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n>t.length)&&(n=t.length),n-=e.length;var o=t.lastIndexOf(e,n);return-1!==o&&o===n});var c={issueCodeUrl:"https://access.line.me/oauth2/v2.1/api/code"};function f(e){return this instanceof f?this.init(e):new f(e)}f.prototype.init=function(e){if(!(e=e||{}).hasOwnProperty("channelId"))throw new Error('"channelId" is required.');for(var n in c)e.hasOwnProperty(n)||(e[n]=c[n]);this.options=e},f.prototype.issueCode=function(e){p()?e.error(i.NOT_SUPPORTED_BROWSER):this._isMaybeLoginSSO()?this._callIssueCodeAPI(e):e.error(i.LOGIN_REQUIRED)},f.prototype._isMaybeLoginSSO=function(){return s.getItem(o)===e},f.prototype._removeIsLoginSSOCookie=function(){var e=this._getParentDomain();e&&s.removeItem(o,"."+e)},f.prototype._getParentDomain=function(){for(var e=location.hostname,n=0;n<r.length;n++){var t=r[n];if(e.endsWith("."+t))return t}return!1},f.prototype._callIssueCodeAPI=function(t){var o=this,e="channelId="+encodeURIComponent(this.options.channelId)+"&"+u(t.data);a(this.options.issueCodeUrl,e,function(e){var n=JSON.parse(e.responseText);t.success(n)},function(e){var n=JSON.parse(e.responseText);401===e.status?(o._removeIsLoginSSOCookie(),t.error(i.LOGIN_REQUIRED,n)):t.error(i.ERROR_RESPONSE,n)})},n.LineLoginSSO=f,n.LineLoginSSO.ERROR_CODES=i}(window,window.document);